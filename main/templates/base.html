<!-- main/templates/base.html -->
<!DOCTYPE html>
<html lang="ru">

<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>{% block title %}–ú–æ—ë –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ{% endblock %}</title>

    <!-- –°—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/hex-grid.css' %}">
    <link rel="stylesheet" href="{% static 'css/cursor.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="animated-bg"></div> <!-- –§–æ–Ω Web3 -->

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">



            <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é -->
            <button class="navbar-toggler order-lg-1" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- –ú–µ–Ω—é  -->
            <div class="collapse navbar-collapse order-lg-1 me-auto" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="#about">–ì–ª–∞–≤–Ω–∞—è</a></li>

                    <li class="nav-item"><a class="nav-link" href="#skills">–ù–∞–≤—ã–∫–∏</a></li>
                    <li class="nav-item"><a class="nav-link" href="#projects">–ü—Ä–æ–µ–∫—Ç—ã</a></li>
                    <li class="nav-item"><a class="nav-link" href="#contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>

                    <button id="theme-toggle" class="btn nav-link" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô</button>
                    </li>

                </ul>
            </div>

        </div>
    </nav>




    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü -->
    {% block content %}
    {% endblock %}

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'js/cursor.js' %}"></script>
    <script src="{% static 'js/hex-grid.js' %}"></script>
    <script src="{% static 'js/noise-bg.js' %}"></script>

    <!-- –°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º—ã -->
    <script>
        const toggleBtn = document.getElementById("theme-toggle");
        const body = document.body;

        if (localStorage.getItem("theme") === "light") {
            body.classList.add("light");
            toggleBtn.textContent = "üåû";
        }

        toggleBtn.addEventListener("click", () => {
            body.classList.toggle("light");

            if (body.classList.contains("light")) {
                localStorage.setItem("theme", "light");
                toggleBtn.textContent = "üåû";
            } else {
                localStorage.setItem("theme", "dark");
                toggleBtn.textContent = "üåô";
            }
        });
    </script>

    <!-- Web3-–∞–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ -->
    <style>
        .animated-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            min-height: 100%;
            background: radial-gradient(circle at 30% 30%, rgb(255, 0, 76), transparent),
                radial-gradient(circle at 70% 70%, #f0f, transparent),
                radial-gradient(circle at 50% 50%, #00f, transparent);
            background-size: 200% 200%;
            animation: moveBg 20s ease-in-out infinite;
            z-index: -1;
            opacity: 0.2;
        }

        html,
        body {
            height: 100%;
            position: relative;
            overflow-x: hidden;
        }

        @keyframes moveBg {
            0% {
                background-position: 0% 0%;
            }

            50% {
                background-position: 100% 100%;
            }

            100% {
                background-position: 0% 0%;
            }
        }
    </style>

    <script>
        const phrases = [
            { text: '–†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—é —Å–∞–π—Ç—ã –Ω–∞ Django', img: '/static/img/django.png' },
            { text: '–°–æ–∑–¥–∞—é Web3-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã', img: '/static/img/web3.png' },
            { text: '–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É—é –ò–ò –≤ –ø—Ä–æ–µ–∫—Ç—ã', img: '/static/img/ai.png' },
            { text: '–õ—é–±–ª—é —É—á–∏—Ç—å—Å—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å', img: '/static/img/learn.png' },
        ];

        let current = 0;
        const textElem = document.getElementById("typewriter-text");
        const imgElem = document.getElementById("typewriter-image");

        function showPhrase(index) {
            const { text, img } = phrases[index];
            textElem.textContent = "";
            imgElem.classList.remove("visible");

            setTimeout(() => {
                imgElem.src = img;
                imgElem.classList.add("visible");
                typeText(text, 0);
            }, 1000);
        }

        function typeText(text, i) {
            if (i < text.length) {
                textElem.textContent += text.charAt(i);
                setTimeout(() => typeText(text, i + 1), 50);
            } else {
                setTimeout(() => eraseText(text.length), 2500); // –ø–æ–¥–µ—Ä–∂–∞—Ç—å –ø–µ—Ä–µ–¥ —Å—Ç–∏—Ä–∞–Ω–∏–µ–º
            }
        }

        function eraseText(i) {
            if (i > 0) {
                textElem.textContent = textElem.textContent.slice(0, -1);
                setTimeout(() => eraseText(i - 1), 30);
            } else {
                imgElem.classList.remove("visible"); // –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏
                setTimeout(() => {
                    current = (current + 1) % phrases.length;
                    showPhrase(current);
                }, 500); // –ø–æ–¥–æ–∂–¥–∞—Ç—å –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π
            }
        }

        showPhrase(current);
    </script>




    <script>
        document.querySelectorAll('.skill-card').forEach(card => {
            card.addEventListener('click', () => {
                const tooltip = card.querySelector('.tooltip-description');

                // –°–∫—Ä—ã—Ç—å –¥—Ä—É–≥–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏
                document.querySelectorAll('.tooltip-description').forEach(t => {
                    if (t !== tooltip) {
                        t.style.display = 'none';
                        t.textContent = '';
                    }
                });

                if (tooltip.style.display === 'block') {
                    tooltip.style.display = 'none';
                    tooltip.textContent = '';
                    return;
                }

                tooltip.style.display = 'block';
                const fullText = tooltip.dataset.text;
                tooltip.textContent = '';
                let i = 0;

                const typer = setInterval(() => {
                    if (i < fullText.length) {
                        tooltip.textContent += fullText.charAt(i);
                        i++;
                    } else {
                        clearInterval(typer);
                    }
                }, 25);
            });
        });

        // –°–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.skill-card')) {
                document.querySelectorAll('.tooltip-description').forEach(t => {
                    t.style.display = 'none';
                    t.textContent = '';
                });
            }
        });
    </script>
    <script>
        document.querySelectorAll('.skill-card').forEach(card => {
            const hover = card.querySelector('.hover-description');
            const fullText = hover.dataset.text;
            let interval = null;

            card.addEventListener('mouseenter', () => {
                let i = 0;
                hover.textContent = "";
                clearInterval(interval);
                interval = setInterval(() => {
                    if (i < fullText.length) {
                        hover.textContent += fullText.charAt(i);
                        i++;
                    } else {
                        clearInterval(interval);
                    }
                }, 25);
            });

            card.addEventListener('mouseleave', () => {
                clearInterval(interval);
                hover.textContent = "";
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script>
        function freezeScreen() {
            html2canvas(document.body, {
                useCORS: true,
                allowTaint: true,
                scrollX: 0,
                scrollY: 0,
                windowWidth: window.innerWidth,
                windowHeight: document.body.scrollHeight,
                scale: 2
            }).then(canvas => {

                const overlay = document.createElement('div');
                overlay.id = 'screenshot-overlay';
                overlay.style.position = 'fixed';
                overlay.style.top = 0;
                overlay.style.left = 0;
                overlay.style.width = '100vw';
                overlay.style.height = '100vh';
                overlay.style.zIndex = 9998;
                overlay.style.overflow = 'hidden';
                overlay.style.pointerEvents = 'none';
                document.body.appendChild(overlay);
                overlay.appendChild(canvas);
                canvas.id = 'screen-capture';
                canvas.style.position = 'absolute';
                canvas.style.top = '0';
                canvas.style.left = '0';
                canvas.style.width = '100vw';
                canvas.style.height = '100vh';
                canvas.style.objectFit = 'cover';
                canvas.style.zIndex = '9999';

                canvas.style.width = '100%';
                canvas.style.height = '100%';

                // —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É ‚Äî –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ä–∞–∑—Ä—É—à–µ–Ω–∏–µ
                setTimeout(() => {
                    const cols = 10;
                    const rows = 6;
                    const width = canvas.width / cols;
                    const height = canvas.height / rows;
                    const ctx = canvas.getContext('2d');

                    const shards = [];

                    for (let y = 0; y < rows; y++) {
                        for (let x = 0; x < cols; x++) {
                            const imageData = ctx.getImageData(x * width, y * height, width, height);
                            const shardCanvas = document.createElement('canvas');
                            shardCanvas.width = width;
                            shardCanvas.height = height;
                            const shardCtx = shardCanvas.getContext('2d');
                            shardCtx.putImageData(imageData, 0, 0);

                            const shard = document.createElement('div');
                            shard.classList.add('shard');
                            shard.style.left = `${(x * 100 / cols)}vw`;
                            shard.style.top = `${(y * 100 / rows)}vh`;
                            shard.appendChild(shardCanvas);

                            overlay.appendChild(shard);
                            shards.push(shard);
                        }
                    }

                    canvas.remove(); // —É–±–∏—Ä–∞–µ–º —Ü–µ–ª—ã–π —Å–∫—Ä–∏–Ω

                    setTimeout(() => {
                        shards.forEach(shard => {
                            const rotate = Math.random() * 720 - 360; // –∫—Ä—É—Ç–∏—Ç—Å—è —Å–∏–ª—å–Ω–µ–µ
                            const translateX = (Math.random() - 0.5) * 300; // –Ω–µ–º–Ω–æ–≥–æ –≤ —Å—Ç–æ—Ä–æ–Ω—ã
                            const translateY = window.innerHeight + Math.random() * 500 + 200;
                            shard.style.transform = `translate(${translateX}px, ${translateY}px) rotate(${rotate}deg) scale(0.8)`;
                            shard.style.opacity = 0.4;
                        });
                    }, 100); // –ø–∞—É–∑–∞ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –∫—Ä—É—à–µ–Ω–∏—è

                    setTimeout(() => {
                        overlay.remove();
                    }, 1500); // –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã


                }, 1000); // —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
            });
        }
    </script>

    <script>
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add("animate-visible");
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.3 });

        document.querySelectorAll('.animate-left, .animate-right').forEach(el => {
            observer.observe(el);
        });
    </script>
</body>

</html>